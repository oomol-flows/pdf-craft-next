version: 1.0.1
scripts:
  # Script executed when the container is first loaded
  # eg: bootstrap: poetry add pandas
  bootstrap: |
    npm install
    apt-get update && apt-get install -y poppler-utils

    # Install specific compatible versions of PyTorch, torchvision, and torchaudio
    # These versions are compatible with vllm 0.11.2 and doc-page-extractor requirements
    echo "Installing PyTorch 2.9.0 with compatible versions"
    pip install torch==2.9.0 torchvision==0.24.0 torchaudio==2.9.0

    pip install timm accelerate
    poetry install --no-root
    pip install --force-reinstall "numpy<2.0"
name: pdf-craft
platform:
  - os: win32
    cpu: x64
    gpu: nvidia
repository: https://github.com/oomol-flows/pdf-craft-next
icon: ./icon.png
displayName: "%display-name%"
description: "%description%"
